(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-950303f0"],{"144f":function(t,e,o){},"4a49":function(t,e,o){"use strict";o.d(e,"a",(function(){return a})),o.d(e,"c",(function(){return s})),o.d(e,"b",(function(){return n}));var r=o("b775");function a(t){return Object(r["a"])({url:"/biz/customer/customerAddOrUpdate",method:"post",data:t})}function s(t){return Object(r["a"])({url:"/biz/customer/"+t,method:"delete"})}function n(t){return Object(r["a"])({url:"/biz/customer/getCustomerExport",method:"post",responseType:"blob",data:t})}},6493:function(t,e,o){"use strict";o.r(e);var r=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-wrapper customer-add-page-wrapper"},[o("s-title",{attrs:{title:"add"==t.title?"新增客户":"编辑客户"}}),t._v(" "),o("div",{staticClass:"user-add-container form-container"},[o("div",{staticStyle:{"margin-bottom":"20px","padding-bottom":"10px","font-size":"16px","font-weight":"bold",color:"#606266","border-bottom":"1px solid #ddd"}},[t._v("客户信息")]),t._v(" "),o("el-form",{ref:"customerForm",attrs:{model:t.customerForm,rules:t.customerRules,"label-width":"120px"}},[o("el-form-item",{staticClass:"form-item",attrs:{label:"客户名称",prop:"customerName"}},[o("el-input",{attrs:{placeholder:"请输入客户名称"},model:{value:t.customerForm.customerName,callback:function(e){t.$set(t.customerForm,"customerName",e)},expression:"customerForm.customerName"}})],1),t._v(" "),o("el-form-item",{staticClass:"form-item",attrs:{label:"行业名称",prop:"tradeName"}},[o("el-input",{attrs:{placeholder:"请输入行业名称"},model:{value:t.customerForm.tradeName,callback:function(e){t.$set(t.customerForm,"tradeName",e)},expression:"customerForm.tradeName"}})],1),t._v(" "),t.city?o("el-form-item",{staticClass:"form-item",attrs:{label:"所在县",prop:"areaArr"}},[o("el-cascader",{staticStyle:{width:"100%"},attrs:{options:t.options,props:t.props},model:{value:t.customerForm.areaArr,callback:function(e){t.$set(t.customerForm,"areaArr",e)},expression:"customerForm.areaArr"}})],1):t._e(),t._v(" "),o("el-form-item",{staticClass:"form-item",attrs:{label:"街道",prop:"road"}},[o("el-input",{attrs:{placeholder:"请输入街道"},model:{value:t.customerForm.road,callback:function(e){t.$set(t.customerForm,"road",e)},expression:"customerForm.road"}})],1),t._v(" "),o("el-form-item",{staticClass:"form-item",attrs:{label:"所在村",prop:"village"}},[o("el-input",{attrs:{placeholder:"请输入所在村"},model:{value:t.customerForm.village,callback:function(e){t.$set(t.customerForm,"village",e)},expression:"customerForm.village"}})],1),t._v(" "),o("el-form-item",{staticClass:"form-item",attrs:{label:"详细地址",prop:"address"}},[o("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:t.customerForm.address,callback:function(e){t.$set(t.customerForm,"address",e)},expression:"customerForm.address"}})],1)],1),t._v(" "),o("div",{staticStyle:{"margin-top":"40px","margin-bottom":"20px","padding-bottom":"10px","font-size":"16px","font-weight":"bold",color:"#606266","border-bottom":"1px solid #ddd"}},[t._v("联系人信息"),o("svg-icon",{staticStyle:{"font-size":"18px","margin-left":"4px",cursor:"pointer"},attrs:{"icon-class":"slw-add2"},on:{click:function(e){t.dialog.flag=!0,t.dialog.type="add"}}})],1),t._v(" "),o("el-table",{staticStyle:{width:"100%"},attrs:{data:t.contactList,border:"",fit:"","highlight-current-row":""}},[o("el-table-column",{attrs:{align:"center",label:"联系人","min-width":"150px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.contactName))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"联系电话","min-width":"150px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.contactMobile))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"备注","min-width":"250px","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",[t._v(t._s(e.row.remark))])]}}])}),t._v(" "),o("el-table-column",{attrs:{align:"center",label:"操作",width:"110px"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("span",{staticClass:"common-table-btn",on:{click:function(o){return t.handleUpdContactBtn(e.row,e.$index)}}},[t._v("编辑")]),t._v(" "),o("span",{staticClass:"common-table-btn",on:{click:function(o){return t.handleDelContactBtn(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),t._v(" "),o("el-button",{staticClass:"common-add-btn",attrs:{type:"primary"},on:{click:function(e){return t.handleAdd()}}},[t._v("保存")])],1),t._v(" "),o("el-dialog",{attrs:{title:"add"==t.dialog.type?"新增联系人":"编辑联系人",visible:t.dialog.flag,"append-to-body":"","before-close":t.contactClose},on:{"update:visible":function(e){return t.$set(t.dialog,"flag",e)}}},[o("el-form",{ref:"contactform",staticStyle:{padding:"0 50px"},attrs:{model:t.contactForm,rules:t.contactRules,"label-width":"80px"}},[o("el-form-item",{staticClass:"form-item-full",attrs:{label:"联系人",prop:"contactName"}},[o("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:t.contactForm.contactName,callback:function(e){t.$set(t.contactForm,"contactName",e)},expression:"contactForm.contactName"}})],1),t._v(" "),o("el-form-item",{staticClass:"form-item-full",attrs:{label:"联系电话",prop:"contactMobile"}},[o("el-input",{attrs:{placeholder:"请输入联系方式"},model:{value:t.contactForm.contactMobile,callback:function(e){t.$set(t.contactForm,"contactMobile",e)},expression:"contactForm.contactMobile"}})],1),t._v(" "),o("el-form-item",{staticClass:"form-item-full",attrs:{label:"备注",prop:"remark"}},[o("el-input",{attrs:{type:"textarea",placeholder:"请输入备注"},model:{value:t.contactForm.remark,callback:function(e){t.$set(t.contactForm,"remark",e)},expression:"contactForm.remark"}})],1)],1),t._v(" "),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:t.contactClose}},[t._v("取 消")]),t._v(" "),"add"==t.dialog.type?o("el-button",{attrs:{type:"primary"},on:{click:t.handleAddContact}},[t._v("确 定")]):o("el-button",{attrs:{type:"primary"},on:{click:t.handleUpdContact}},[t._v("修 改")])],1)],1)],1)},a=[],s=(o("e186"),o("2aab")),n=o("4a49");o("b775");var c=o("b405"),l=o("61f7"),i=o("7e1e"),m=function(t,e,o){Object(l["e"])(t,e,o)},u={name:"customerAdd",components:{STitle:c["default"]},data:function(){return{title:"add",city:!1,customerForm:{customerName:null,address:null,areaCode:null,cityCode:null,provinceCode:null,road:null,tradeName:null,village:null,areaArr:[]},contactList:[],contactForm:{contactName:null,contactMobile:null,remark:null},delContaceIds:[],customerRules:{customerName:[{required:!0,message:"请输入客户名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],tradeName:[{required:!0,message:"请输入行业名称",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],address:[{required:!0,message:"请输入详细地址",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],areaArr:[{required:!0,message:"请选择省市区",trigger:"change"}]},contactRules:{contactName:[{required:!0,message:"请输入联系人",trigger:"blur"},{min:1,max:20,message:"长度在 1 到 20 个字符",trigger:"blur"}],contactMobile:[{required:!0,message:"请输入正确的11位手机号码",trigger:"blur",validator:m}]},dialog:{type:"add",flag:!1},options:[],props:{value:"code",label:"name"}}},created:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.address();case 2:console.log("address",this.options),this.$route.meta.title="新增客户",e=this.$route.query,e.id&&(this.title="update",this.$route.meta.title="编辑客户",this.handleUpdate(e.id));case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{handleAdd:function(){var t=this;console.log("customerForm",JSON.stringify(this.customerForm)),this.$refs.customerForm.validate((function(e){if(!e)return!1;if(0!==t.contactList.length){console.log(t.customerForm.areaArr[0]),t.customerForm.provinceCode=t.customerForm.areaArr[0]||"",t.customerForm.cityCode=t.customerForm.areaArr[1]||"",t.customerForm.areaCode=t.customerForm.areaArr[2]||"";var o={contactList:t.contactList,customer:t.customerForm,delContaceIds:t.delContaceIds};console.log(o),n["a"](o).then((function(e){"1"==e.data.code?t.$notify({title:"失败",message:"保存失败,"+e.data.msg,type:"error",duration:2e3}):"0"==e.data.code&&(t.$notify({title:"成功",message:"保存成功",type:"success",duration:2e3}),t.$router.push({path:"/customer/index"}))}))}else t.$alert("联系人不能为空，请添加联系人","提示",{confirmButtonText:"确定"})}))},handleUpdate:function(t){var e=i["a"].customerchange;this.customerForm=e,this.customerForm.areaArr=[e.provinceCode,e.cityCode,e.areaCode],this.contactList=e.contactList,console.log(e)},address:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e,o,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e=i["a"].provinceList,this.options=e,o=i["a"].cityList,this.options[0].children=o,r=i["a"].areaList,this.options[0].children[0].children=r,this.city=!0;case 7:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleUpdContactBtn:function(t,e){this.contactForm=JSON.parse(JSON.stringify(t)),this._index=e,this.dialog.flag=!0,this.dialog.type="update"},handleDelContactBtn:function(t,e){void 0!==t.contactId&&null!==t.contactId&&this.delContaceIds.push(t.contactId),this.contactList.splice(e,1),console.log("aaaa",t,this.delContaceIds)},handleAddContact:function(){var t=this,e=this,o=[];e.contactList.map((function(t){o.push(t.contactMobile)}));var r=o.join(","),a=r.indexOf(e.contactForm.contactMobile);console.log(a),-1==a?this.$refs.contactform.validate((function(e){e&&(t.contactList.push(JSON.parse(JSON.stringify(t.contactForm))),t.$refs.contactform.resetFields(),t.contactClose())})):alert("手机号码重复")},handleUpdContact:function(){var t=this;this.$refs.contactform.validate((function(e){e&&(t.$set(t.contactList,t._index,JSON.parse(JSON.stringify(t.contactForm))),console.log(t.contactList),t.$refs.contactform.resetFields(),t.contactClose())}))},contactClose:function(){this.dialog.flag=!1}}},d=u,p=(o("83b0"),o("0b56")),f=Object(p["a"])(d,r,a,!1,null,"013d2c74",null);e["default"]=f.exports},"83b0":function(t,e,o){"use strict";o("144f")}}]);